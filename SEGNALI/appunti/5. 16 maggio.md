```toc
style: bullet
min_depth: 1
max_depth: 2
```

# SISTEMI TEMPO-DISCRETO
## INTRODUZIONE
Fondamentale nella realtà lavorare in tempo discreto (ad esempio per progettare i filtri) perché risulta più facile. Ecco perché introduciamo i sistemi tempo-discreto.
- La trattazione è simile a quella del mondo tempo continuo (stessi concetti con definizioni ri-adattate al tempo discreto)

Un sistema tempo discreto è una *associazione* tra una sequenza $x[n]$ e una sequenza di uscita $y[n]$ che viene generata grazie a un operatore $T$, in questo modo:
$$
y[n] = T\big(x[n]\big)
$$
- così come nel mondo continuo avevamo una associazione $x(t) \rightarrow y(t)$
- nel mondo tempo discreto abbiamo una sequenza e un *sistema (descritto dall'operatore $T$)* che associa tale sequenza a un'altra sequenza di uscita
	Dalle caratteristiche di $T$ derivano tutte le informazioni utili per studiare questo argomento

## PROPRIETA' DEI SISTEMI

### SENZA MEMORIA
Se:
$$
y[n_{0}]  \quad \text{dipende soltanto da } x[n_{0}]
$$
Ovvero se $y$ all'istante $n_{0}$ dipende solo da $x[n_{0}]$, ovvero solo dall'ingresso al medesimo istante (non da quelli passati o futuri)

### SISTEMA LINEARE
Se vale il *principio di sovrapposizione degli effetti*:
$$
T(a_{1} \ x_{1}[n] + a_{2} \ x_{2}[n] ) = a_{1} \ T(x_{1}[n]) + a_{2} \ T(x_{2}[n] )
$$
- Operatore $T$ applicato alla somma degli ingressi uguale alla somma dell'operatore $T$ applicato ai singoli ingressi
 
### TEMPO INVARIANTE
Si ha:
$$
\begin{align*}
&y[n] \quad\quad\ = T(x[n]) \\
\Rightarrow \ &y[n-n_{0}] = T(x[n-n_{0}])
\end{align*}
$$
Applicando l'operatore $T$ (sistema) all'ingresso traslato di $n_{0}$ campioni, si ottiene la sequenza di uscita traslata anch'essa di $n_{0}$ campioni

### CAUSALE
Se:
$$
y[n_{0}]  \quad \text{dipende soltanto da } x[n_{0}],n[n_{0-1}],x[n_{0-1}]\dots
$$
Ovvero dipende soltanto dai campioni dell'ingresso agli istanti precedenti

### STABILE (in senso BIBO)
Se:
$$
|x(t)|<k  \quad , \quad \forall t
$$
Esiste cioè una fascia $[-k;k]$ tale che riesce a "racchiudere il segnale".
![[Pasted image 20220519102311.png|300]]

Un segnale è **bibo-stabile** se:
$$
\forall \ x[n] \ \text{ limitato} \implies y[n] \ \text{ limitato}
$$
(ingresso limitato - uscita limitata)

# SISTEMA LINEARE TEMPO INVARIANTE (LTI)
- Dimostrazione analoga al caso continuo

Vale la seguente relazione:

$$
x[n] = x[n] * \delta[n] = \sum_{k=-\infty}^{\infty} x[k] \ \delta[n-k]
$$
- Ovvero ogni sequenza è la somma di tanti impulsi discreti unitari $\delta$ traslati e poi moltiplicati per i campioni della sequenza
![[Pasted image 20220519103254.png|400]]

Proviamo adesso a inserire il risultato della convoluzione all'interno dell'operatore $T$:
$$
y[n] = T(x[n]) = T(\sum_{k=-\infty}^{\infty} x[k] \ \delta[n-k])
$$
- Applicando la *linearità*:
$$
= \sum_{k=-\infty}^{\infty} x[k] \ T(\delta[n-k])
$$
- Definiamo ora: $\displaystyle h[n] = T(\delta[n])$ (vedi dopo):
- Applichiamo quindi la *tempo invarianza* così da avere valida la relazione:
$$
h[n-k] = T(\delta[n-k])
$$
	- Si ottiene quindi:
$$
\huge\boxed{\sum_{k=-\infty}^{\infty} x[k] h[n-k] = x[n] * h[n]}
$$
	- (dove $h$ è la *risposta impulsiva del sistema*, ovvero la risposta del sistema quando l'ingresso è un impulso discreto unitario: $h[n]=T(\delta[n])$)
	*- Quindi si nota che se un sistema è LTI, l'uscita è sempre calcolabile come l'ingresso convoluto per una sequenza particolare ovvero la risposta impulsiva*
		- Quindi una volta noto l'ingresso e $h[n]$ posso calcolare tutte le uscite del sistema

![[Pasted image 20220519112453.png]]


## CLASSIFICAZIONE DEGLI LTI
A differenza del mondo tempo continuo, è importante nel mondo tempo discreto classificare i sistemi in base al tipo di risposta impulsiva (finita, infinita). 
In particolare:
#### SISTEMI FIR
$$
h[n] \longrightarrow \text{sequenza finita (Finite Impulse Response [FIR])}
$$
#### SISTEMI FIR
$$
h[n] \longrightarrow \text{sequenza infinita (Ininite Impulse Response [IIR])}
$$


## CONNESSIONE IN PARALLELO
![[Pasted image 20220519114637.png|400]]

Si ha una uscita generale $y[n]$ così definita:
$$
\begin{align*}
y[n]&=y_{1}[n]+y_{2}[n] \\
&=x[n] * h_{1}[n]+x[n] * h_{2}[n]\\
&= x[n] * (h_{1}[n]+h_{2}[n])\\
&= x[n] \ \ * \underbrace{h[n]}_{h_{1}[n]+h_{2}[n]}
\end{align*}
$$
- L'ultima riga ci garantisce che il sistema è LTI
- La riposta impulsiva totale è la *somma* delle due risposte impulsive

## CONNESSIONE IN SERIE (cascata)
![[Pasted image 20220519115140.png|400]]

Si ha una uscita generale $y[n]$ così definita:
$$
\begin{align*}
y[n]&=y_{1}[n]*h_{2}[n] \\
&=\underbrace{(x[n] * h_{1}[n])}_{y_{1}[n]}*h_{2}[n]\\
&= x[n] * (h_{1}[n]*h_{2}[n])\\
&= x[n] \ \ * \underbrace{h[n]}_{h_{1}[n]*h_{2}[n]}
\end{align*}
$$
L'ultima riga ci garantisce che il sistema è LTI
- La riposta impulsiva totale è la *convoluzione* delle due risposte impulsive
- L'ordine della serie non è importante grazie alle proprietà dell'operatore di convoluzione

## STABILITA'
Abbiamo già detto che un sistema tempo-discreto è *bibo-stabile* se $\forall x[n] \ \ \text{limitato} \rightarrow \ y[n] \ \text{limitata}$ 
- vale per tutti i sistemi (non solo per gli LTI)

Se il sistema è LTI (cioè avente caratteristiche particolari come già visto), cosa si può dire **in più** per la *stabilità*? C'è qualche condizione "meno forte" o alternativa che me la garantisce?
- Si può dimostrare [TEOREMA] che se un sistema è bibo-stabile, allora **la risposta impulsiva è assolutamente sommabile**, ovvero
$$
\text{Sistema bibo-stabile} \Rightarrow \ \sum_{n=-\infty}^{\infty} |h[n]| < \infty
$$
Si dimostra che si può dire anche il contrario, ovvero:
$$
\text{Sistema bibo-stabile} \Leftarrow \ \sum_{n=-\infty}^{\infty} |h[n]| < \infty
$$
Allora si può riassumere in questo modo:
$$
\boxed{\huge \text{Sistema bibo-stabile} \iff \ \sum_{n=-\infty}^{\infty} |h[n]| < \infty }
$$

**Dimostrazione:**
[analoga al tempo continuo]
- si basa in senso "$\Rightarrow$" sul fatto che l'uscita è la convoluzione dell'ingresso alla risposta impulsiva
- si basa in senso "$\Leftarrow$" per assurdo


Vediamo come questo teorema influisce sulla stabilità dei vari sistemi.

### STABILITA' DEI FIR
>> I sistemi $FIR$ sono sempre *stabili*

Infatti, se $h[n]$ è una sequenza finita di $N$ campioni (lunghezza risposta impulsiva):
$$
h[n] = \{ h[0],h[1],\dots,h[N-1] \}
$$
Allora vale (la sommatoria si riduce):
$$
\sum_{n=0}^{N-1} |h[n]| < \infty \quad \text{(perché i campioni sono finiti)}
$$
### STABILITA' DEI IIR
>> Non sempre è garantita la stabilità dei sistemi $IIR$

Infatti se $h[n]$ è composta da un numero infinito di campioni (nota: $h[n]$ può essere: *monolatera sinistra, destra o bilatera*) allora abbiamo la stabilità solo se l'assoluta sommabilità è verificata, ovvero:
$$
h[n] \ \text{stabile solo se vale } \ \sum_{n=-\infty}^{\infty} (h[n])<\infty  
$$
- Dobbiamo cioè per i sistemi $IIR$ vedere la risposta impulsiva caso per caso (non si può dire niente a priori sulla stabilità)

### STABILITA' DEI SISTEMI CAUSALI
Sistema causale:
$$
y[n_{0}] \ \text{dipende solo dai campioni passati}
$$
Si può valutare la causalità di un sistema osservando la risposta impulsiva?
$$
\begin{align*}
y[n_{0}] &= \sum_{k=-\infty}^{\infty} h[k] \ x[n_{0}-k] \\
&= \underbrace{\dots h[-2]x[n_{0}+2]  + h[-1]x[n_{0}+1]}_{\text{non devono comparire}}+ \ h[0]x[n_{0}]+h[1]x[n_{0}-1]+h[1]x[n_{0}-2]\dots
\end{align*}
$$
Pertanto vale se:
$$
h[k] = 0  \quad , \quad k<0
$$
*In questo modo l'uscita dipende solo dai campioni del presente e del passato (non futuri)*

Pertanto anche la causalità si deduce bene dalla osservazione soltanto della risposta impulsiva

## SISTEMI ELEMENTARI
### RITARDATORE
Sia:
$$
h[n] = \delta[n-n_{0}]
$$
Allora l'uscita sarà data da:
$$
\begin{align*}
y[n] &= x[n] *h[n]\\
&= \sum_{k=--\infty}^{\infty} h[k]x[n-k]\\
&= \sum_{k=-\infty}^{\infty} \underbrace{\delta [k-n_{0}]}_{\begin{cases}
k=n_{0} \rightarrow 1 \\k \neq n_{0} \rightarrow 0
\end{cases}} x[n-k]\\
&=x[n-n_{0}]
&\end{align*}
$$
Pertanto un impulso ritardato di $n_{0}$ inserito nel sistema ritardatore causa un ritardo dell'ingresso

### A MEDIA MOBILE

$$
h[n]=\begin{cases}
\frac{1}{N} & 0 \leq n \leq N-1 \\
0 & \text{altrove}
\end{cases}
$$
![[Pasted image 20220519124522.png]]
- È evidentemente una sequenza $FIR$ 
- Ricorda un rettangolo nel tempo

Ci chiediamo quale sia l'effetto di questo sistema sul segnale d'ingresso.
$$
\begin{align*}
y[n] &= x[n]*h[n]\\
&= \sum_{k=-\infty}^{\infty} h[k]\ x[n-k]\\
&= \sum_{k=0}^{N-1} \frac{1}{N}\ x[n-k]\\
&= \frac{1}{N} \sum_{k=0}^{N-1} \ x[n-k]
\end{align*}
$$
Ovvero il sistema a ogni istante $n$ fornisce in output la somma degli ultimi $n$ campioni diviso $N$, ovvero ne fa *la media*.
Graficamente (finestra mobile):
![[Pasted image 20220519125452.png|500]]

###  INTEGRATORE
Sia:
$$
h[n] = u[n]
$$
In uscita:
$$
\begin{align*}
y[n] &= x[n] * u[n]\\
&= \sum_{k=-\infty}^{\infty} u[k] \cdot x[n-k]\\
&= \sum_{k=0}^{\infty} \underbrace{u[k]}_{1} \cdot x[n-k]
\end{align*}
$$
Quindi:
$$
y[n] = \sum_{k=0}^{\infty} x[n-k]
$$
>> Esegue cioè la **somma dei campioni precedenti**, ovvero una specie d'integrazione dei campioni arrivati*

Graficamente (all'istante $n$ esegue la somma di tutti i campioni precedenti. Si riesegue poi per ogni istante):
![[Pasted image 20220519130009.png|400]]

In generale, *questo sistema non è stabile!* (perché la finestra di somma è composta potenzialmente da infiniti termini)

- Ad esempio se abbiamo un gradino, non vale la *bibo-stabilità*: la sequenza gradino è infatti limitata, ma l'uscita è illimitata (abbiamo una rampa):
![[Pasted image 20220519130253.png|400]]
- ciò si notava anche dalla risposta impulsiva, infatti $\sum_{n=-\infty}^{\infty} |h[n]|$, con $h[n]=u[n]$ non è assolutamente sommabile, ovvero $\sum_{n=-\infty}^{\infty} |u[n]|=\infty$


**NOTA:** l'uscita di una sequenza instabile non per forza è illimitata. Esempio:
$$
x[n] = \cos 2\pi F_{0}n \ u[n]
$$
- è instabile ma la risposta non è illimitata

### DERIVATORE
L'inverso dell'integratore:
$$
h[n]= \{ 1;-1\} = \begin{cases}
1 & n=0 \\
-1 & n=1 \\
0 & \text{altrove}
\end{cases}
$$
![[Pasted image 20220519130738.png]]

Si ottiene facendo i conti:
$$
y[n] = x[n] - x[n-1]
$$
- che assomiglia a una derivazione (per quanto possibile nel mondo discreto)

## COME POSSIAMO DESCRIVERLO
Per descrivere un sistema LTI nel mondo continuo abbiamo
- Preso un generico $h(t)$ che rappresenta la risposta impulsiva, ovvero la risposta del sistema alla delta di Dirac
- Eseguito la sua trasformata di Fourier, ovvero ottenuto la risposta in frequenza $H(f)$: essa fornisce le informazioni per calcolare l'uscita quando l'ingresso è un tono (puro)
- Se abbiamo una equazione differenziale viene prodotto un sistema LTI
	- Per descrivere l'equazione differenziale potremmo usare in modo alternativo la trasformata di Laplace $H(S)$ (ma non l'abbiamo trattata)

Abbiamo poi fatto già il parallelo nel mondo tempo discreto, infatti abbiamo:
- Preso una sequenza $h[n]$ che rappresenta l'equivalente della risposta impulsiva, ovvero la risposta del sistema alla sequenza impulso discreto unitario. Grazie a tale sequenza sappiamo definire una convoluzione nel mondo tempo discreto che ci permette di calcolare l'uscita in modo semplice
- La sua trasformata ha un utilizzo simile alla risposta in frequenza nel caso tempo continuo (ma ancora dobbiamo descrivere tale passaggio). Si indica comunque con $H(F)$
- Se abbiamo una *equazione alle differenze finite* viene prodotto un sistema LTI tempo discreto.
	- Per descriverle, faremo uso della *trasformata Z* della risposta impulsiva, ovvero $H(Z)$, che viene detta funzione di trasferimento

Riassumendo:
![[Pasted image 20220519154041.png]]

## EQUAZIONE ALLE DIFFERENZE FINITE
Un sistema in cui vale la seguente relazione:
$$
\sum_{k=0}^{N} a_{k} \ y[n-k] = \sum_{k=0}^{M} b_{k}\ x[n-k]
$$
**è un sistema LTI**.
Tale equazione è detta *equazione alle differenze finite*.
- E' il modo più semplice per implementare un sistema LTI (nella pratica)

Infatti (**Dimostrazione:**):

Supponendo $a_{0}\neq 0$, si ottiene:
$$
a_{0}\ y[n] + \sum_{k=1}^{N} a_{k}\ y[n-k] = \sum_{k=0}^{M} b_{k}\ x[n-k]
$$
Dividendo per $a_{0}$ e portando a destra la sommatoria:
$$
y[n] = \underbrace{-\sum_{k=1}^{N} \frac{a_{k}}{a_{0}}\ y[n-k]}_{\text{uscite precedenti}} + \underbrace{\sum_{k=0}^{M} \frac{b_{k}}{a_{0}}\ x[n-k]}_{\text{ingressi precedenti}}
$$
In maniera alternativa ma più sintetica, si può giungere al seguente risultato:
$$
\large \boxed{y[n] = \underbrace{-\sum_{k=1}^{N} a_{k}\ y[n-k]}_{\text{uscite precedenti}} + \underbrace{\sum_{k=0}^{M} b_{k}\ x[n-k]}_{\text{ingressi precedenti}}}
$$
Ovvero: *l'uscita $y[n]$ è calcolabile utilizzando gli ingressi e le uscite precedenti*
	**- ed è inoltre calcolabile in modo sistematico (algoritmico)**
![[Pasted image 20220519160425.png|500]]
- Dove in generale $M,N,a_k,b_k$ sono da scegliere in fase di progetto
## FUNZIONE DI TRASFERIMENTO
Permette di passare dalla risposta impulsiva alla equazione alle differenze finite o viceversa.

Se consideriamo $y[n]$ generico (ovvero: $y[n] = x[n] * h[n]$) a cui applichiamo la trasformata Z ambo i membri si ottiene:
$$
Y[z] = x[z] \cdot h[z] 
$$
Quindi:
$$
H(Z) = \mathcal{Z}\{ h[n] \}
$$
, ovvero la trasformata Z della risposta impulsiva.

Analogamente:
$$
H(Z) = \frac{Y(z)}{X(z)}
$$
, ovvero il rapporto tra le trasformate Z di uscita e ingresso.


## LEGAME EQ. ALLE DIFF. FINITE CON H(Z)
### TRASFORMATA -->
Dall'equazione alle differenze finite:
$$\sum_{k=1}^{N} a_{k}\ y[n-k] = \sum_{k=0}^{M} b_{k}\ x[n-k]$$
Applichiamo la trasformata Z ambo i membri:
$$
\sum_{k=0}^{N} a_{k} \ Y(z)\cdot z^{-k} = \sum_{k=0}^{M} b_k X(z) \cdot z^{-k}
$$
Da cui:
$$
	Y(z) \sum_{k=0}^{N} a_{k}\ z^{-k} = X(z)\sum_{k=0}^{M} b_{k} \ z^{-k}
$$
Quindi:
$$
H(Z)=\frac{Y(Z)}{X(Z)}=\frac{\sum_{k=0}^{M} b_{k} \ z^{-k}}{\sum_{k=0}^{N} a_{k}\ z^{-k}}
$$

Quindi partendo dalla equazione alle differenze finite (dipendente e legata da alcuni coefficienti da scegliere in fase di progetto $N,M,a_k,b_k$), abbiamo ricavato la funzione di trasferimento come il rapporto di due polinomi, che appunto è:
$$
\boxed{\huge H(Z)=\frac{\sum_{k=0}^{M} b_{k} \ z^{-k}}{\sum_{k=0}^{N} a_{k}\ z^{-k}}}
$$- è cioè una *funzione razionale*, che sappiamo trattare in particolar modo bene nel dominio Z

### ANTITRASFORMATA <--
Partendo dalla $H(Z)$ si può eseguire il passaggio inverso eseguendo l'antitrasformata, ovvero vale:
$$
H(Z) \overbrace{\longrightarrow}^{\huge z^{-1}} h[n]
$$
- che si può effettuare dato che $H(Z)$ è razionale nei casi che abbiamo visto

### LEGAME FIR - IIR nelle EQ. ALLE DIFFERENZE

#### Caso $FIR$ 
- con $N$ campioni (finiti): 
$$
h[n] \quad \{ h[0],h[1],\dots,h[N-1] \}
$$
Eseguendo la convoluzione con un segnale d'ingresso come già visto si ottiene:
$$
y[n] = \sum_{k=0}^{N-1}h[k] \ x[n-k] 
$$
, ovvero produce una *equazione alle differenze finite*. Con la particolarità che:
- **Utilizza solo gli ingressi precedenti per calcolare l'uscita $y[n]$** (non vengono utilizzate le uscite precedenti)
	- (A volte detto per questo non ricorsiva)

La relativa funzione di trasferimento:
$$
\begin{align*}
H(Z) &= \sum_{n=-\infty}^{\infty} h[n] \ z^{-n}\\
&= \sum_{n=0}^{N-1} h[n] \ z^{-n} 
\end{align*}
$$
**È un polinomio**


#### Caso $IIR$
Si ha:
$$
y[n] = -\sum_{k=1}^{N}a_k \ y[n-k] +\sum_{k=0}^{M}b_K \ x[n-k] 
$$
Ha come abbiamo già visto (supponendo $a_{0}=1$):
$$
H(Z) = \frac{\sum_{k=0}^{M} b_{k} z^{-k}}{1+\sum_{k=1}^{N} a_{k}\ z^{-k}}
$$
Quindi in pratica $H(Z)$ (funzione razionale e dipendente anche dalle uscite precedenti) ha necessariamernte una risposta impulsiva $h[n]$ di tipo $IRR$ (o viceversa), perché
- è legato alla trasformata inversa delle funzioni razionali
	- Infatti *se ci sono dei poli*, allora vengono prodotte queste possibili sequenze:
![[Pasted image 20220519165815.png|500]]
Aventi **tutte** un numero infinito di campioni (e quindi la risposta impulsiva sarà IIR).

In maniera duale (leggendo al contrario tale relazione):
>> Un sistema IIR ha necessariamente una funzione di trasferimento razionale (con il denominatore avente dei poli che producono sequenze esponenziali di durata infinita) e una equazione alle differenze finite in cui per calcolare l'uscita servono le uscite precedenti.


