# SEGNALI TEMPO DISCRETO
## INTRODUZIONE
> [!Definizione e Caratteristiche]
> - Sequenze di numeri
> - Indicate con $x[n], \quad n \in \mathbb{Z} \text{, che stabilisce l'ordine della variabile x}$
> 

> [!Esempi]
> - numero di auto che passano attraverso un casello autostradale [nasce discreto]
> - segnale vocale [nasce analogico, lo analizzo come discreto (grazie al campionamento)]

Se nei segnali tempo continuo si cercava con l'analisi in frequenza di ricavare informazioni sulla *periodicità* del segnale, adesso coi segnali tempo discreto si cerca di estrarre un certo tipo di ***ciclicità***.

$$\underbrace{t. continuo}_{periodicita'} \iff \underbrace{t. discreto}_{ciclicita'}$$
Lo strumento per fare ciò rimarrà lo stesso, ovvero la *trasformata di Fourier*, anche se sarà applicata in modo diverso.

$$ \boxed{x(t) \underbrace{\rightarrow}_{Campionamento} x[n]\quad  \underbrace{\rightarrow}_{TDF} \quad X(f) } $$

dove $TDF = \text{trasformata discreta di Fourier}$
- Nota: il passaggio in frequenza è utile perché dallo spettro si ricavano numerosi informazioni (ad esempio lo spettro di un segnale vocale mostra dei picchi di risonanza che permettono di distinguere un fonema emesso da un altro).

### CAMPIONAMENTO
Passaggio $x(t) \rightarrow x[n]$, dove:
$$ \begin{cases}
x[n] = x(t) | _{t=nT}  \\
T = \text{passo di campionamento} \\
f_{c}= \text{frequenza di campionamento (\# campioni in un un sec.)}
\end{cases}$$
> [!question] Ricostruzione del segnale
> Sotto opportune ipotesi, si può anche fare il passaggio inverso, ovvero $$x[n] \rightarrow x(t),$$ ovvero si può ricostruire il segnale analogico a partire dai campioni
> Per fare ciò:
$$\xrightarrow{x(t)} \boxed{ADC} \xrightarrow{x[n]} \boxed{DAC} \xrightarrow{x(t)}  $$ Dove: $ADC = \text{Analog to Digital converter}$, $DAC = \text{Digital to Analog converter}$

## TEOREMA DEL CAMPIONAMENTO
Si vuole eseguire il passaggio: $$ x(t) \rightarrow x_{c} \ (t) \quad,$$dove $x_c(t)$ rappresenta il segnale analogico campionato. In particolare:
$$ x_c(t)=x(t)\cdot p(t) \quad ,$$
con $p(t)$ *funzione pettine di Dirac*, così espressa: $$ p(t) = \sum_{n=-\infty}^{\infty}\delta(t-nT)  $$
Pertanto, svolgendo i conti:


$$ x_{c}(t) = x(t) \cdot \bigg(\sum_{n=-\infty}^{\infty}\delta(t-nT) \bigg) = \sum_{n=-\infty}^{\infty}x(t) \cdot \delta(t-nT) = \sum_{n=-\infty}^{\infty}x(nT) \cdot \delta(t-nT)    $$
- Nota: il vantaggio di questa nuova formulazione sta ne fatto che $x_c(t)$ dipende soltanto dai campioni, mentre in quella precedente dipendeva dal segnale analogico $x(t)$.

Riassumendo quindi:
$$ \boxed{x_c(t) = x(t) \cdot p(t) = \sum_{n=-\infty}^{\infty}x(nT) \cdot \delta(t-nT)} $$
### Trasformata del segnale campionato
Ci chiediamo ora di trovare la relazione: $$ x_c(t)\iff X_c(f)$$
- Essendo $p(t)$ analogico e **periodico** di periodo **T**, posso rappresentarlo come *serie di Fourier*:
$$ p(t) = \sum_{k=-\infty}^{\infty} c_{k}\cdot e^{j2\pi \frac{k}{T}t}  $$
I coefficienti di Fourier $c_k$ per definizione sono:
$$ c_{k}= \frac{1}{T}\int_{-T/2}^{T/2} \delta(t)\cdot e^{-j2\pi \frac{k}{T}t}\,dt  $$
- Dalle proprietà della $\delta$ , sappiamo che dall'integrale di un segnale impulsivo moltiplicato per una funzione si ottiene il valore della funzione calcolata nel punto in cui è posizionata la $\delta$.
	- $\delta$ è posizionata in $T = 0$
	- La funzione è l'esponenziale complesso (che per $T=0$ vale $1$)
Quindi:
$$ c_{k}=\frac{1}{T} $$
Da cui finalmente:
$$ \boxed{p(t) = \frac{1}{T}\sum_{k=-\infty}^{\infty} e^{j2\pi \frac{k}{T}t}}  $$

Sostituendo questo nuovo risultato al posto di $x_c(t)=x(t)\cdot p(t)$ e portando $x(t)$ dentro la sommatoria, si ottiene:
$$ x_{c}(t)=\frac{1}{T} \sum_{k=-\infty}^{\infty} x(t) \cdot e^{j2\pi \frac{k}{T}t} $$
Posso ora definire la **trasformata**, sfruttando la proprietà di linearità:
$$ X_c(f)=\mathscr{F}\{ x_c(t) \}=\frac{1}{T} \sum_{-\infty}^{\infty} \mathscr{F}\{x(t) \cdot e^{j2\pi \frac{k}{T}t }\} $$
- Eseguire la trasformata del prodotto tra un segnale $x(t)$ e l'esponenziale complesso comporta una *traslazione in frequenza* del valore di $f_0$, che vale nel nostro caso $\displaystyle \frac{k}{T}$ . Ecco quindi che si ottiene **lo spettro del segnale campionato**:
 $$\boxed{X_c(f)=\frac{1}{T} \sum_{k=-\infty}^{\infty} X\big(f-\frac{k}{T}
 \big)} $$
Analogamente:
$$X_c(f)=f_c \sum_{k=-\infty}^{\infty} X\big(f-kf_c
 \big) $$
```ad-info
title: Osservazioni

- $X_c(f)$ è una funzione **periodica** di periodo **$f_c$**
- $X_c(f)$ si costruisce partendo da $X(f)$ e sommando tutte le sue versioni traslate di multipli di $f_c$ (a "destra e sinistra"). Ogni replica è moltiplicata per un valore $f_c$
```

 > [!warning] Passaggio inverso
> Il passaggio inverso (ovvero **ricostruire il segnale a partire dai campioni**), grazie a delle opportune osservazioni, si può eseguire solo se sono rispettate le seguenti **condizioni necessarie:**
> $$\begin{cases} \text{Lo Spettro ha banda Limitata}\\ f_{c}\geq \frac{f_{c}}{2} \end{cases}$$
> La seconda condizione è fondamentale per evitare *aliasing* (sovrapposizione) tra le repliche
> Il mezzo con cui si ricostruisce il segnale è un filtro **passa-basso** con frequenza di taglio $f_{c}\geq \frac{f_{c}}{2}$ e guadagno $\displaystyle \frac{1}{f_c}$
> 

Possiamo quindi enunciare il **teorema del campionamento**:
> [!quote]  >
> Dato un segnale a **banda limitata** (ovvero $|X(f)|=0$ per $f > B$) con $f_{c}>2B$, allora è possibile ricostruire $x(t)$ dai campioni $x(nT) = x[n]$  

- Nota: $f_c=2B$ viene detta *frequenza di Nyquist*


## INTERPOLAZIONE CARDINALE
Abbiamo visto che:

$$
x(t) \longrightarrow \boxed{campionatore} \longrightarrow x(nT)=x[n]=\int_{-T/2}^{T/2} x(t)\cdot\delta(t-nT) \,dt 
$$
E il passaggio inverso:
$$
x[n] \longrightarrow \boxed{formatore \ di \ impulsi} \xRightarrow{x_c(t) = \sum_{n=-\infty}^{\infty} x[n] \cdot \delta (t-nT) } \boxed{filtro \ di \ ricostruzione} \longrightarrow x(t)
$$
- Dove il $\text{filtro di ricostruzione}$ è un filtro **passa basso** ideale, che possiamo quindi esprimere così:

$$ H_{LP}(f) =
\begin{cases}
\frac{1}{f_{c}}& 0\leq |f|\leq \frac{f_c}{2} \\
0 & altrove
\end{cases}
\quad = \frac{1}{f_{c}}\cdot rect\bigg(\frac{f}{f_{c}}\bigg) $$
Possiamo quindi calcolarci l'antitrasformata, ottenendo:
$$h_{LP}(t) = sinc(t \cdot f_c)\quad ,
$$
che è appunto una funzione $sinc$ che vale $1$ in $t=0$ e ha gli zeri nei multipli interi di $\frac{t}{f_{c}}$, ovvero nei multipli di $T$ (cfr. relazione tra $T$ e $f_c$).


Come visto $x_c$ va in ingresso al $\text{filtro di ricostruzione}$ e questo da luogo al segnale $x(t)$. Pertanto:
$$
\begin{align*}
x(t) &= x_{c}(t) * h(t) \\
&= \bigg( \sum_{n=-\infty}^{\infty} x[n] \cdot \delta(t-nT) \bigg) * h(t)\\
&= \sum_{n=-\infty}^{\infty} x[n] \cdot \bigg( \delta(t-nT) * h(t) \bigg)\\
&= \sum_{n=-\infty}^{\infty} x[n] \cdot h(t-nT)\\
&= x[n] \cdot sinc \big( f_{c}\cdot (t-nT) \big)
\end{align*}
$$

--> Dunque per ricostruire il segnale faccio le seguenti cose:
- Considero i vari campioni $\dots , x[-1], x[0], x[1], x[2], \dots$, che sono come detto posizionati nei multipli di $T$;
- Moltiplico ogni campione $n-esimo$ per un $sinc$, che ha gli zeri negli istanti di campionamento degli altri campioni (per come è definito) e vale $1$ nel punto in cui è posizionato il campione $n-esimo$ di riferimento. Reitero come detto per ogni campione.
![[interpolazione.png]]
- Si esegue quindi la somma di tutti i $sinc$ costruiti per ogni istante $T$.
	- Tale somma rappresenta proprio la **ricostruzione del segnale**.
	- Viene denominata *interpolazione cardinale*.

**Nota**: è un caso ideale, perché abbiamo utilizzato un filtro LP ideale.

## TRASFORMATA DI FOURIER PER SEQUENZE 

> [!abstract] Intro
> Andiamo a ottenere **in un modo alternativo** la trasformata $X_c(f)$
> - Il significato finale è lo stesso, ma la forma è alternativa rispetto a quella calcolata precedentemente

Sappiamo che:
$$
x_c(t)=\sum_{n=-\infty}^{\infty} x[n] \cdot \delta(t-nT)
$$

Da cui:
$$
\begin{align*}
\mathscr{F}\{ x_c(t) \} &= \int_{-\infty}^{\infty} x_c(t) \cdot e^{-j2\pi ft}\,dt\\
&=\int_{-\infty}^{\infty} \bigg( \sum_{n=-\infty}^{\infty} x[n] \cdot \delta(t-nT) \bigg) \cdot e^{-j2\pi ft} \,dt\\
&= \sum_{n=-\infty}^{\infty} x[n] \underbrace{\int_{-\infty}^{\infty} \delta(t-nT)e^{-j2\pi ft} \,dt }\\
\end{align*}
$$
Possiamo quindi riscrivere, per le propietà della $\delta$:
$$
\boxed{X_c(f)= \sum_{n=-\infty}^{\infty} x[n] \cdot e^{j2\pi f nT} } 
$$
- Posso con questa formula calcolare la **trasformata a partire dai campioni**.
- Useremo sempre questa per calcolare lo spettro di un segnale campionato.
	- Con l'altra formula, ovvero $\displaystyle{X_c(f) = f_c \sum_{k=-\infty}^{\infty} X(f-f_c)}$ dovrei partire dalla trasformata del segnale analogico e quindi sommare le versioni traslate dello spettro (come visto)  :(

***Con una notazione alternativa (più comune)***:
$$
\overline{X(f)} = \sum_{n=-\infty}^{\infty} x[n] \cdot e^{-j2\pi fnT}
$$
```ad-example
title: E' ancora periodica di periodo $f_c$.

Basta mostrare che:
$$
\begin{align*}
\overline{X(f+f_c)} &= \sum_{n=-\infty}^{\infty} x[n] e^{-j2\pi fnT }\\
&= \sum_{n=-\infty}^{\infty} x[n]e^{-j2\pi fnT } \cdot e^{-j2\pi f_c n T}\\
& \text{dato che } f_c \cdot T =1  \text{  (il 2° esponenziale viene 1)}\\
= \overline{X(f)} & \quad \quad C.V.D.
\end{align*}
$$
```

> [!attention] Frequenze Normalizzate
>  Spesso è più comodo utilizzare al posto della variabile "fisica" $f$ una *variabile normalizzata $F$*, ovvero: $$
f \longrightarrow f \ T = \frac{f}{f_{c}}= \boxed{F} $$ 
> - Tale $F$ viene detta appunto **frequenza normalizzata**. 
> - Ne consegue quindi la seguente definizione alternativa della trasformata: $$
\huge\boxed{\overline{X}(f)= \sum_{n=-\infty}^{\infty} x[n] \cdot e^{-j2\pi Fn}} $$
> - E' ancora un segnale **periodico** di periodo **1**
> - Essendo soltanto un modo differente di esprimere lo stesso concetto di **trasformata di Fourier per sequenze**, si può passare da una forma all'altra senza problemi con i soli cambi di variabile necessari, cioè "riscalando" gli assi (se necessario: vedi esempi lezione 28/04 - 2:06:00)

## ANTITRASFORMATA DI FOURIER PER SEQUENZE
> [!abstract] Intro
> Calcolare la sequenza $x[n]$ a partire dalla funzione "normalizzata" $\overline{X}(F)$, cioè: $$ \overline{X}(F) \longrightarrow x[n]$$.


Cambiando solamente l'indice ($n \rightarrow m$), sappiamo che:
$$
\overline{X}(F) = \sum_{m=-\infty}^{+\infty} x[m] \cdot e^{j2\pi Fm}
$$

Se adesso a $\overline{X}(F)$:
- moltiplichiamo $\displaystyle{e^{j2 \pi F n}}$
- integriamo tra $\displaystyle \frac{-1}{2}$ e $\displaystyle \frac{1}{2}$
Si ottiene:
$$
\bigg(\int_{-1/2}^{1/2} \underbrace{\sum_{m=-\infty}^{+\infty} x[m] \cdot e^{j2\pi Fm}}_{\overline{X}(F)} \,dF \bigg) \cdot {e^{j2 \pi F n}} = \sum_{m=-\infty}^{\infty} x[m] \underbrace{\int_{-1/2}^{1/2} e^{-j2 \pi F(m-n)} \,dF}_{\bigstar}
$$

- $$
\begin{align*}\bigstar =
&
\int_{-1/2}^{1/2} cos(2 \pi F(m-n)) \,dF - j \int_{-1/2}^{1/2} sin 2 \pi F (m-n) \,dF\\
=& \begin{cases}
\text{rimane } \int e^0  dF \quad\text{ e quindi } 1 & \text{se } m=n\\
\int  \text{(coseno e seno per un certo numero intero di periodi)} & \text{se } m\neq n
\end{cases}
\end{align*}
$$
- Da cui, finalmente:
$$x[n] = \begin{cases}
1 & \text{se} \ \ m=n \\
0 & \text{altrimenti}
\end{cases}
$$
 In conclusione (*prendendo in considerazione solo quando* **$x[n]=1$**):
 $$
 \huge\boxed{x[n] = \int_{-1/2}^{1/2} \overline X (F) \cdot e^{j2\pi FN} \,dF}
$$
è **l'antitrasformata per sequenze della funzione $\overline X(F)$**;
	- E' la somma (integrale) di tanti esponenziali complessi ognuno a frequenza normalizzata $F$, la cui ampiezza è infinitesima e vale $\overline{X}(f)\cdot dF$ (peso in fase di ricostruzione).
		- Stessa visione della espansione in serie/trasformata di Fourier

> [!example] Frequenze Fisiche
> Per le frequenze fisiche, ricordando che $f = F \cdot f_c$, si dimostra analogamente che:
> $$ x[n] = T \int_{\frac{-1}{2T}}^{\frac{1}{2T}} x[n] \cdot e^{j2\pi fnT} \,df$$
> .

### CONDIZIONE SUFFICIENTE PER LA CONVERGENZA
Vogliamo ottenere per la convergenza: 
$$ \boxed{|\overline X (f)|<\infty}$$
- Si dimostra che questo vale quando 
$$
\sum_{n=-\infty}^{\infty} |x[n]| < \infty
$$
Infatti:
$$
\begin{align*}
|\overline X (f) | &= | \sum_{n=-\infty}^{\infty} x[n] e^{-j2\pi Fn}|\\
&\leq \sum_{n=-\infty}^{\infty} |x[n]| \cdot |\underbrace{e^{-j2\pi Fn}}_1| \quad  \quad \text{(disuguaglianza triangolare)}\\
&= \underbrace{\sum_{n=-\infty}^{\infty} |x[n]|}\\
	&\text{se essa è limitata, allora anche } \overline X(F) \text{ lo e' e quindi converge}
\end{align*}
$$
Quindi: *assoluta sommabilità di $x[n]$ implica la convergenza della trasformata di Fourier per sequenze*.

**Nota**: esistono altre condizioni per la convergenza *meno forti* (vedi sequenza costante [[2. 2 e 5 maggio]])

## ESEMPI
### Calcolo di $\overline X (f)$ della sequenza $x[n] = a^n \cdot u[n]$
- dove$$u[n] = \begin{cases}
1 & n \geq 0 \\
0 & \text{altrove}
\end{cases}$$
Supponendo $\boxed{a < 1}$ si ha:

![[Pasted image 20220503004140.png]]

![[Pasted image 20220503004556.png]]
(serie geometrica di ragione q)

Quindi, sostituendo il segnale al posto di $q$, otteniamo la trasformata:
![[Pasted image 20220503004830.png]]

Anche in questo caso la trasformata è una funzione **complessa** della variabile **$F$**, pertanto si può espimere/rappresentare in **modulo** e **fase**, coi relativi *spettri* di *ampiezza e fase*.

Partiamo a calcolare lo **spettro di ampiezza**:
- Separiamo parte reale e parte immaginaria, sfruttando le formule di Eulero:
$$
\overline{X}(f)= \frac{1}{1-a\cos 2\pi F \quad+ \quad ja \sin 2\pi F}
$$
- Troviamo il **modulo**:
$$
|\overline{X}(f)| = \frac{1}{\sqrt{(Re)^2+(Im)^{2}}}= \frac{1}{\sqrt{(1-a\cos2\pi F)^2+(ja \sin 2\pi F)^2}} = \frac{1}{\sqrt{1+a^2-2\cos 2a\pi}}
$$

> Ponendo $a=0.5$, otteniamo il seguente grafico (essendo periodica di periodo 1):
![[Pasted image 20220503121850.png]]

Proseguiamo con il calcolo della **fase**:
$$
\overline{X}(f)= \underbrace{\frac{1-a\cos 2\pi F - ja \sin 2\pi F}{|1- a \cos 2\pi F + ja \sin 2 \pi F | ^2}}_{Razionalizzazione}
$$
$$
\angle \overline{X}(f) = \arctan\left(\frac{Re}{Im}\right) = \arctan{\left(\frac{-a \sin 2\pi F}{1-a\cos 2\pi F}\right)} \underbrace{=}_{dispari} -\arctan{\left(\frac{a \sin 2\pi F}{1-a\cos 2\pi F}\right)}
$$
![[Pasted image 20220503122953.png]]

$\checkmark Dispari$
